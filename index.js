(function(){"use strict";function h(l,t,e,i,s,n,r,u){var a=typeof l=="function"?l.options:l;t&&(a.render=t,a.staticRenderFns=e,a._compiled=!0),i&&(a.functional=!0),n&&(a._scopeId="data-v-"+n);var c;if(r?(c=function(o){o=o||this.$vnode&&this.$vnode.ssrContext||this.parent&&this.parent.$vnode&&this.parent.$vnode.ssrContext,!o&&typeof __VUE_SSR_CONTEXT__<"u"&&(o=__VUE_SSR_CONTEXT__),s&&s.call(this,o),o&&o._registeredComponents&&o._registeredComponents.add(r)},a._ssrRegister=c):s&&(c=u?function(){s.call(this,(a.functional?this.parent:this).$root.$options.shadowRoot)}:s),c)if(a.functional){a._injectStyles=c;var y=a.render;a.render=function(H,f){return c.call(f),y(H,f)}}else{var d=a.beforeCreate;a.beforeCreate=d?[].concat(d,c):[c]}return{exports:l,options:a}}const p={props:{disabled:Boolean,empty:String,help:String,label:String,required:Boolean,type:String,duplicate:{type:Boolean,default:!0},headers:{type:Boolean,default:!0},index:{type:[Number,Boolean],default:1},minColumns:{type:Number,default:2},maxColumns:{type:Number,default:5},sortable:{type:Boolean,default:!0},value:[String,Array]},computed:{values(){return[...this.table]},columns(){return this.hasHeaders?this.table[0]:this.table[0].length>0?Array(this.table[0].length).fill(""):Array(this.minColumns).fill("")},rows(){return this.hasHeaders?this.table.slice(1):this.table},colspan(){let l=this.columns.length;return this.hasIndexColumn&&l++,l},hasHeaders(){return this.headers},hasIndexColumn(){return this.isSortable||this.index!==!1},isSortable(){return!(this.disabled===!0||this.index===!1||this.sortable===!1)},table(){const l=s=>s.trim().replace(/^- /,"").replace(/^[\"\'](.*)[\"\']$/g,"$1"),t=s=>s==="- ",e=this.hasHeaders?2:1;let i=typeof this.value=="string"?this.value.split(`
`).reduce((s,n)=>(t(n)?s.push([]):s[s.length-1].push(l(n)),s),[]):this.value;return i||(i=Array.from({length:e},()=>Array(this.minColumns).fill(""))),i},dragOptions(){return{disabled:!this.sortable,fallbackClass:"k-table-row-fallback",ghostClass:"k-table-row-ghost"}},tableOptions(){return[{click:()=>this.remove("all"),disabled:this.rows.length===0&&this.columns.length<=this.minColumns,icon:"trash",text:this.$t("delete.all")}]},columnOptions(){return[{disabled:this.columns.length>=this.maxColumns,icon:"angle-left",text:this.$t("insert.before"),click:"insertBefore"},{disabled:this.columns.length>=this.maxColumns,icon:"angle-right",text:this.$t("insert.after"),click:"insertAfter"},"-",{icon:"eraser",text:this.$t("field.table.clear"),click:"clear"},{disabled:!this.duplicate||this.columns.length>=this.maxColumns,icon:"copy",text:this.$t("duplicate"),click:"duplicate"},"-",{disabled:this.columns.length<=this.minColumns,icon:"trash",text:this.$t("delete"),click:"remove"}]},rowOptions(){return[{icon:"angle-up",text:this.$t("insert.before"),click:"insertBefore"},{icon:"angle-down",text:this.$t("insert.after"),click:"insertAfter"},"-",{icon:"eraser",text:this.$t("field.table.clear"),click:"clear"},{disabled:!this.duplicate,icon:"copy",text:this.$t("duplicate"),click:"duplicate"},"-",{disabled:this.rows.length<=1,icon:"trash",text:this.$t("delete"),click:"remove"}]}},methods:{columnOption(l,t){switch(l){case"insertBefore":this.insert("column",t,"before");break;case"insertAfter":this.insert("column",t,"after");break;case"clear":this.clear("column",t);break;case"duplicate":this.duplicate("column",t);break;case"remove":this.remove("column",t);break}},rowOption(l,t){switch(l){case"insertBefore":this.insert("row",t,"before");break;case"insertAfter":this.insert("row",t,"after");break;case"clear":this.clear("row",t);break;case"duplicate":this.duplicate("row",t);break;case"remove":this.remove("row",t);break}},showDialog(l,t){this.$panel.dialog.open({component:"k-remove-dialog",props:{text:l},on:{submit:()=>{t(),this.update(),this.$panel.dialog.close()}}})},add(l){l==="column"?this.table.forEach(t=>t.push("")):l==="row"&&this.table.push(Array(this.columns.length).fill("")),this.update()},insert(l,t,e="before"){const i=l==="column"?t:this.hasHeaders?t+1:t,s=e==="before"?i:i+1;l==="column"?(this.columns.splice(s,0,""),this.rows.forEach(n=>n.splice(s,0,""))):l==="row"&&this.table.splice(s,0,Array(this.columns.length).fill("")),this.update()},clear(l,t){const e=this.hasHeaders?t+1:t;l==="column"?this.table.forEach(i=>i[t]=""):l==="row"&&this.table[e].fill(""),this.update()},duplicate(l,t){const e=this.hasHeaders?t+1:t;l==="column"?(this.columns.splice(t+1,0,this.columns[t]),this.rows.forEach(i=>i.splice(t+1,0,i[t]))):l==="row"&&this.table.splice(e,0,this.table[e]),this.update()},remove(l,t){if(l==="column"){const e=this.$t("field.table.delete.confirm.column");this.showDialog(e,()=>{this.table.forEach(i=>i.splice(t,1))})}else if(l==="row"){const e=this.$t("field.table.delete.confirm.row");this.showDialog(e,()=>{const i=this.hasHeaders?t+1:t;this.table.splice(i,1)})}else if(l==="all"){const e=this.$t("field.table.delete.confirm.all");this.showDialog(e,()=>{this.columns.splice(0,this.columns.length,Array(this.minColumns).fill("")),this.table.splice(0,this.table.length,Array(this.minColumns).fill(""))})}},onDrag(l,t){const e=t==="column"?-1:this.hasHeaders?1:0,i=l.oldIndex+e,s=l.newIndex+e;t==="column"?(this.columns.splice(s,0,...this.columns.splice(i,1)),this.rows.forEach(n=>n.splice(s,0,...n.splice(i,1)))):t==="row"&&this.table.splice(s,0,...this.table.splice(i,1)),this.update()},update(){this.$emit("input",this.table)}}};var b=function(){var t=this,e=t._self._c;return e("k-field",t._b({staticClass:"k-table-field",scopedSlots:t._u([t.disabled?null:{key:"options",fn:function(){return[e("k-button-group",{attrs:{layout:"collapsed"}},[e("k-button",{attrs:{disabled:t.columns.length>=t.maxColumns,text:t.$t("field.table.column"),icon:"add",variant:"filled",size:"xs"},on:{click:function(i){return t.add("column")}}}),e("k-button",{attrs:{icon:"dots",size:"xs",variant:"filled"},on:{click:function(i){return t.$refs.options.toggle()}}}),e("k-dropdown-content",{ref:"options",attrs:{options:t.tableOptions,"align-x":"end"}})],1)]},proxy:!0}],null,!0)},"k-field",t.$props,!1),[e("div",{staticClass:"k-table",attrs:{"aria-disabled":t.disabled}},[e("table",{attrs:{"data-disabled":t.disabled,"data-indexed":t.hasIndexColumn}},[e("thead",[e("k-draggable",{attrs:{list:t.values,options:t.dragOptions,handle:!0,element:"tr"},on:{end:function(i){return t.onDrag(i,"column")}}},[t.hasIndexColumn?e("th",{staticClass:"k-table-index-column"},[t._v("#")]):t._e(),t._l(t.columns,function(i,s){return e("th",{key:s+"-header",staticClass:"k-table-column k-table-header",attrs:{"data-sortable":t.isSortable}},[e("k-bar",[t.isSortable?e("k-sort-handle",{staticClass:"k-table-sort-handle"}):t._e(),t.hasHeaders?e("k-text-input",{attrs:{type:"text",spellcheck:!1,placeholder:`${t.$t("field.table.column")} ${s+1}`},on:{input:function(n){return t.update()}},model:{value:t.columns[s],callback:function(n){t.$set(t.columns,s,n)},expression:"columns[columnIndex]"}}):e("k-text",[t._v(t._s(t.$t("field.table.column"))+" "+t._s(s+1))]),t.disabled?t._e():e("k-options-dropdown",{attrs:{options:t.columnOptions},on:{option:function(n){return t.columnOption(n,s)}}})],1)],1)}),!t.disabled&&t.rows.length!==0?e("th",{staticClass:"k-table-options-column"}):t._e()],2)],1),e("k-draggable",{attrs:{list:t.values,options:t.dragOptions,handle:!0,element:"tbody"},on:{end:function(i){return t.onDrag(i,"row")}}},[t.rows.length===0?e("tr",[e("td",{staticClass:"k-table-empty",attrs:{colspan:t.colspan}},[t._v(" "+t._s(t.empty??t.$t("field.table.empty.rows"))+" ")])]):t._l(t.rows,function(i,s){return e("tr",{key:s},[t.hasIndexColumn?e("td",{staticClass:"k-table-index-column",attrs:{"data-sortable":t.isSortable&&t.rows.length>1}},[e("div",{staticClass:"k-table-index",domProps:{textContent:t._s(t.index+s)}}),t.isSortable&&t.rows.length>1?e("k-sort-handle",{staticClass:"k-table-sort-handle"}):t._e()],1):t._e(),t._l(i,function(n,r){return e("td",{key:r,staticClass:"k-table-column k-table-cell"},[e("k-writer-input",{attrs:{inline:!0,nodes:!1,spellcheck:!1},on:{input:function(u){return t.update()}},model:{value:i[r],callback:function(u){t.$set(i,r,u)},expression:"row[columnIndex]"}})],1)}),t.disabled?t._e():e("td",{staticClass:"k-table-options-column"},[e("k-options-dropdown",{attrs:{options:t.rowOptions},on:{option:function(n){return t.rowOption(n,s)}}})],1)],2)})],2)],1)]),t.disabled?t._e():e("footer",[e("k-button",{attrs:{text:t.$t("field.table.row"),icon:"add",size:"xs",variant:"filled"},on:{click:function(i){return t.add("row")}}})],1)])},m=[],k=h(p,b,m,!1,null,null,null,null);const _=k.exports,g={computed:{table(){return this.content.table??Array.from({length:2},()=>Array(2).fill(""))},columns(){return this.table[0]},rows(){return this.table.slice(1)}}};var v=function(){var t=this,e=t._self._c;return e("div",{staticClass:"k-table"},[e("table",[e("thead",[e("tr",t._l(t.columns,function(i,s){return e("th",{key:s,staticClass:"k-table-column"},[e("k-text-input",{attrs:{type:"text",spellcheck:!1,placeholder:`${t.$t("field.table.column")} ${s+1}`},on:{input:function(n){return t.update()}},model:{value:t.columns[s],callback:function(n){t.$set(t.columns,s,n)},expression:"columns[columnIndex]"}})],1)}),0)]),e("tbody",t._l(t.rows,function(i,s){return e("tr",{key:s},t._l(i,function(n,r){return e("td",{key:r,staticClass:"k-table-column"},[e("k-writer-input",{attrs:{inline:!0,nodes:!1,spellcheck:!1},on:{input:function(u){return t.update()}},model:{value:i[r],callback:function(u){t.$set(i,r,u)},expression:"row[columnIndex]"}})],1)}),0)}),0)])])},C=[],$=h(g,v,C,!1,null,null,null,null);const w=$.exports;panel.plugin("bogdancondorachi/table-field",{fields:{table:_},blocks:{table:w},icons:{table:'<path d="M3 3C2.44772 3 2 3.44772 2 4V20C2 20.5523 2.44772 21 3 21H21C21.5523 21 22 20.5523 22 20V4C22 3.44772 21.5523 3 21 3H3ZM11 5V8H4V5H11ZM4 14V10H11V14H4ZM4 16H11V19H4V16ZM13 16H20V19H13V16ZM20 14H13V10H20V14ZM20 5V8H13V5H20Z"></path>',eraser:'<path d="M8.58564 8.85449L3.63589 13.8042L8.83021 18.9985L9.99985 18.9978V18.9966H11.1714L14.9496 15.2184L8.58564 8.85449ZM9.99985 7.44027L16.3638 13.8042L19.1922 10.9758L12.8283 4.61185L9.99985 7.44027ZM13.9999 18.9966H20.9999V20.9966H11.9999L8.00229 20.9991L1.51457 14.5113C1.12405 14.1208 1.12405 13.4877 1.51457 13.0971L12.1212 2.49053C12.5117 2.1 13.1449 2.1 13.5354 2.49053L21.3136 10.2687C21.7041 10.6592 21.7041 11.2924 21.3136 11.6829L13.9999 18.9966Z"></path>'}})})();
